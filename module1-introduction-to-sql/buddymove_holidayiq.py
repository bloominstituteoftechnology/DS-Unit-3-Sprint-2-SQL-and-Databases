{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "conn = sqlite3.connect('rpg_db.sqlite3')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Opened as needed\n"
     ]
    }
   ],
   "source": [
    "cursor = conn.cursor()\n",
    "print(\"Opened as needed\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Aliquid iste optio reiciendi\n",
      "Optio dolorem ex a\n",
      "Minus c\n",
      "Sit ut repr\n",
      "At id recusandae expl\n",
      "Non nobis et of\n",
      "Perferendis\n",
      "Accusantium amet quidem eve\n",
      "Sed nostrum inventore error m\n",
      "Harum repellendus omnis od\n",
      "Itaque ut commodi,\n",
      "Molestiae quis\n",
      "Ali\n",
      "Tempora quod optio possimus il\n",
      "Sed itaque beatae pari\n",
      "Quam dolor\n",
      "Molestias expedita\n",
      "Lauda\n",
      "Incidunt sint perferen\n",
      "Laboriosa\n",
      "Dolore esse nesciunt fugit com\n",
      "Dolorum nam reic\n",
      "Repellat ad numquam volu\n",
      "Facere enim velit eligend\n",
      "Sed ratione quis rep\n",
      "Doloribus neque\n",
      "Ab voluptas se\n",
      "Molestias m\n",
      "In pariatur corpori\n",
      "Possimus ad dignissimos vel, a\n",
      "At minus accusa\n",
      "Ad necess\n",
      "Expedita c\n",
      "Voluptates sunt voluptas volu\n",
      "Autem mollitia fuga lauda\n",
      "Sint quibusdam ob\n",
      "Rerum et o\n",
      "Doloribus dolore r\n",
      "Eaque su\n",
      "Vel molestias numqua\n",
      "Iste assumenda repellat q\n",
      "Animi labo\n",
      "Eum culpa eaque ea omn\n",
      "Harum provident vel quam\n",
      "Aspe\n",
      "Nisi nequ\n",
      "Quod tempora\n",
      "Porro aliq\n",
      "Quas\n",
      "Magnam eligendi quia animi\n",
      "Officiis se\n",
      "Id assumend\n",
      "Voluptatibus fu\n",
      "Odit rat\n",
      "Debit\n",
      "Cum aut quas repudia\n",
      "Deleniti qui quae quidem\n",
      "Adipisci voluptas\n",
      "Debitis sit ratione eos nam\n",
      "Esse illo molestias archi\n",
      "Sunt at itaque voluptatum d\n",
      "Est totam\n",
      "Reprehenderit commodi eius\n",
      "Debit\n",
      "Soluta dol\n",
      "Vel nesc\n",
      "Ratione quia ali\n",
      "Rerum recusandae minima\n",
      "Totam natus eius fugiat volu\n",
      "Perferendis commodi null\n",
      "Laudantiu\n",
      "Voluptat\n",
      "Incidunt nesciun\n",
      "Illum amet vero\n",
      "Suscipit exercitationem re\n",
      "Quas enim error maxime nisi m\n",
      "Labore qu\n",
      "Repudiandae deleniti unde\n",
      "Ut do\n",
      "Quaerat esse labore q\n",
      "Quidem aliq\n",
      "Aperiam vitae eos dolor sed\n",
      "Minus nobis porro\n",
      "In similique\n",
      "Culpa repellat unde\n",
      "Architecto i\n",
      "A sed pariatur qua\n",
      "Tempore assumenda aperiam\n",
      "Sed ullam tempora iusto co\n",
      "Ipsa\n",
      "Fugiat incidun\n",
      "Molestiae of\n",
      "Quae quisquam cons\n",
      "Repellendus ea non facil\n",
      "Quod non quibu\n",
      "Numquam velit distinctio\n",
      "Necessitatibus nihil ex debi\n",
      "Velit tempore nemo, na\n",
      "Nesciunt v\n",
      "Dicta enim debitis accusantiu\n",
      "Vitae a\n",
      "Praesentium voluptas u\n",
      "Unde ullam mollitia? Nu\n",
      "Neque molestias qu\n",
      "Officiis es\n",
      "Beatae mi\n",
      "Mollitia nam corporis temp\n",
      "Repudiandae repellat i\n",
      "Laboriosam\n",
      "Nam minus amet\n",
      "Harum quae volup\n",
      "Impedit facere ulla\n",
      "Enim\n",
      "Dolore magni\n",
      "Eaque at corpori\n",
      "Fug\n",
      "Dolorum laudanti\n",
      "Perferendis nat\n",
      "Cupidi\n",
      "Commodi eius dicta digniss\n",
      "Debitis eu\n",
      "Nihil repella\n",
      "Rem quasi minima hic sed anim\n",
      "Sed ali\n",
      "Earum vol\n",
      "Inventore tempore com\n",
      "Repell\n",
      "Consequatur quis recusandae qu\n",
      "Dolores ea velit mi\n",
      "Atque blanditiis a aperiam\n",
      "Reprehenderit sequi iu\n",
      "Natus architecto eos, hic blan\n",
      "Ipsa illo quas\n",
      "Voluptas ali\n",
      "Voluptates obcaecati quod e\n",
      "Dolor adipisci a voluptate\n",
      "Repellendus natus quae, n\n",
      "Laudantium earum nam in dol\n",
      "Molestias face\n",
      "Maiores suscipit exc\n",
      "Illum dolore perferen\n",
      "Explicabo recusandae ma\n",
      "Odio obcaecati hic nostrum n\n",
      "Voluptate ali\n",
      "Repudiandae vitae sapiente mol\n",
      "Ipsam cumque\n",
      "Fugiat quos alias eos dese\n",
      "Eaque impe\n",
      "Elige\n",
      "Adip\n",
      "Fuga nemo vel mo\n",
      "Libero cumque impedit eveniet\n",
      "Odio soluta\n",
      "Vero nostrum duc\n",
      "Repellend\n",
      "Quod\n",
      "Suscipit reiciend\n",
      "Voluptat\n",
      "Porro dolor fuga quam\n",
      "Amet quo fugit aliquam sequi\n",
      "Magni adipisci veritatis sit q\n",
      "Debitis enim cumque cum qu\n",
      "Dolorem eligend\n",
      "Autem lib\n",
      "Saepe assumenda perferendis f\n",
      "Deserunt\n",
      "Provident soluta simil\n",
      "In accu\n",
      "Inve\n",
      "Placeat sapiente\n",
      "Ducimus architecto ullam\n",
      "Voluptate tempora rerum\n",
      "Totam incidunt earum perspicia\n",
      "Optio quas e\n",
      "Ab illum invento\n",
      "Repellat quis natus totam, s\n",
      "Est voluptate accusantium tem\n",
      "Beatae q\n",
      "Velit\n",
      "Minus nequ\n",
      "Autem eos voluptates off\n",
      "Vel fug\n",
      "Architecto repudian\n",
      "Opti\n",
      "Iust\n",
      "Sapiente\n",
      "Officiis repellat corrupti su\n",
      "Dicta et natus e\n",
      "At quos\n",
      "Laborum ven\n",
      "Exceptur\n",
      "Reiciendis assumenda dolo\n",
      "Poss\n",
      "Acc\n",
      "Placeat esse archit\n",
      "Enim repellendus nihil est te\n",
      "Ipsam incidunt t\n",
      "Iure\n",
      "Illo en\n",
      "A rem ex\n",
      "Officiis su\n",
      "Numquam molestias\n",
      "Voluptates unde\n",
      "Quae praesentium vel\n",
      "Quas\n",
      "Dolores aliquid inv\n",
      "Mollitia tempore laborum eaqu\n",
      "Nobis voluptates fugiat quia\n",
      "Similique dolorem dolore maio\n",
      "Sapiente\n",
      "Officia nisi dolore\n",
      "Distinctio\n",
      "Eos quia dignissimos saepe vel\n",
      "Ullam neque sint eligendi\n",
      "Excepturi deleniti ab a\n",
      "Accusa\n",
      "Reiciendis laboriosam di\n",
      "Delectus ex\n",
      "Pari\n",
      "Veritatis velit facilis iste\n",
      "Dol\n",
      "Qui iste pr\n",
      "Deleni\n",
      "Reprehenderit volu\n",
      "Accusantium vitae n\n",
      "Natus consequatur incidun\n",
      "Dignissimos a\n",
      "Vitae modi\n",
      "Accusantium qu\n",
      "Reiciendis dignissimos ratio\n",
      "Expedita provident natus volup\n",
      "Rerum repellat voluptas c\n",
      "Maiores quos incidunt dolor\n",
      "Aper\n",
      "Nulla\n",
      "Laudantium tempora itaque\n",
      "Reprehenderit\n",
      "Aliqu\n",
      "Odio harum nam mole\n",
      "Arc\n",
      "Reprehenderit li\n",
      "Repr\n",
      "Optio m\n",
      "Esse odit amet rep\n",
      "Provident nostrum minima\n",
      "Ex nihil quae facilis a omni\n",
      "Dolorem quaerat sunt\n",
      "Distinctio\n",
      "Repudiandae ip\n",
      "Iste debitis dolorum amet m\n",
      "Non qui vo\n",
      "Dolorem ma\n",
      "Molestias labore tempore ita\n",
      "Vol\n",
      "Adipisci molest\n",
      "Omni\n",
      "Voluptatibus dolor\n",
      "Quo\n",
      "Atque aspernatur possi\n",
      "Ullam c\n",
      "Iusto quas voluptatibu\n",
      "Optio qui sunt dolores, ab\n",
      "Illum recusandae nulla re\n",
      "Verita\n",
      "Expedita quod blanditiis\n",
      "Mag\n",
      "Omnis quos aspernatur d\n",
      "Sunt impedit co\n",
      "Minima quam ea ad\n",
      "Suscipit quidem e\n",
      "Harum\n",
      "Dolore laborum ips\n",
      "Magni veniam earum corporis\n",
      "Optio\n",
      "Nam fugit vel.\n",
      "Ut numquam quam eum, alias ius\n",
      "Error amet tempore nulla\n",
      "Deserunt a\n",
      "Aperiam sit\n",
      "Asperi\n",
      "Similique aperiam earum expli\n",
      "Iure h\n",
      "At sint ducimus nostrum i\n",
      "Reprehenderit temporib\n",
      "Molestiae quaerat maxim\n",
      "Maior\n",
      "Unde natus ut ipsa cupi\n",
      "Praesentium atque ear\n",
      "Rem minima\n",
      "Provident sed soluta, sed si\n",
      "Natus quia veritatis\n",
      "Vero a\n",
      "Optio harum labori\n",
      "Duci\n",
      "Ipsa elige\n",
      "Sunt blanditiis i\n",
      "Doloremque\n",
      "Autem ratione vitae quos, do\n",
      "Voluptatibus aliquid\n",
      "Quaerat sequi sit eius corpori\n",
      "Libe\n",
      "Aliquam n\n"
     ]
    }
   ],
   "source": [
    "query = \"\"\"SELECT name FROM charactercreator_character\"\"\"\n",
    "\n",
    "\n",
    "for row in cursor.execute(query):\n",
    "    print(row[0])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(302,)]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_character\"\"\"\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(108,)]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_mage\"\"\"\n",
    "cursor.execute(query).fetchall()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(11,)]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_necromancer\"\"\"\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(51,)]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_thief\"\"\"\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(75,)]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_cleric\"\"\"\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(68,)]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM charactercreator_fighter\"\"\"\n",
    "cursor.execute(query).fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "def df_sql(query, conn=conn):\n",
    "    return pd.read_sql_query(query, conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>COUNT (*)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>174</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   COUNT (*)\n",
       "0        174"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM armory_item\"\"\"\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>COUNT (*)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   COUNT (*)\n",
       "0         37"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT COUNT (*) FROM armory_weapon\"\"\"\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#37 are weapons, 137 are not"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>character_id</th>\n",
       "      <th>COUNT(item_id)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    character_id  COUNT(item_id)\n",
       "0              1               3\n",
       "1              2               3\n",
       "2              3               2\n",
       "3              4               4\n",
       "4              5               4\n",
       "5              6               1\n",
       "6              7               5\n",
       "7              8               3\n",
       "8              9               4\n",
       "9             10               4\n",
       "10            11               3\n",
       "11            12               3\n",
       "12            13               4\n",
       "13            14               4\n",
       "14            15               4\n",
       "15            16               1\n",
       "16            17               5\n",
       "17            18               5\n",
       "18            19               3\n",
       "19            20               1"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = \"\"\"SELECT character_id, COUNT(item_id) FROM charactercreator_character_inventory \n",
    "GROUP BY character_id\n",
    "LIMIT 20\"\"\"\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AVG(Num_Weapons)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.672185</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   AVG(Num_Weapons)\n",
       "0          0.672185"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = (\n",
    "    '''      SELECT AVG(Num_Weapons) FROM (\n",
    "             SELECT COUNT(item_ptr_id) AS Num_Weapons\n",
    "               FROM charactercreator_character_inventory \n",
    "    LEFT OUTER JOIN armory_weapon\n",
    "                 ON charactercreator_character_inventory.item_id = armory_weapon.item_ptr_id\n",
    "           GROUP BY character_id\n",
    "           )\n",
    "    '''\n",
    ")\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AVG(Num_Items)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2.97351</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   AVG(Num_Items)\n",
       "0         2.97351"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = (\n",
    "    '''      SELECT AVG(Num_Items) FROM (\n",
    "             SELECT COUNT(item_id) AS Num_Items\n",
    "               FROM charactercreator_character_inventory \n",
    "           GROUP BY character_id\n",
    "           )\n",
    "    '''\n",
    ")\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>character_id</th>\n",
       "      <th>Num_Weapons</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    character_id  Num_Weapons\n",
       "0              1            0\n",
       "1              2            0\n",
       "2              3            0\n",
       "3              4            0\n",
       "4              5            2\n",
       "5              6            0\n",
       "6              7            1\n",
       "7              8            0\n",
       "8              9            0\n",
       "9             10            0\n",
       "10            11            1\n",
       "11            12            0\n",
       "12            13            0\n",
       "13            14            0\n",
       "14            15            0\n",
       "15            16            0\n",
       "16            17            0\n",
       "17            18            0\n",
       "18            19            0\n",
       "19            20            1"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "query = (\n",
    "    '''      SELECT character_id, Num_Weapons FROM (\n",
    "             SELECT character_id, COUNT(item_ptr_id) AS Num_Weapons\n",
    "               FROM charactercreator_character_inventory \n",
    "    LEFT OUTER JOIN armory_weapon\n",
    "                 ON charactercreator_character_inventory.item_id = armory_weapon.item_ptr_id\n",
    "           GROUP BY character_id\n",
    "           LIMIT 20\n",
    "           )\n",
    "    '''\n",
    ")\n",
    "df_sql(query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.read_csv('buddymove.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "User Id      0\n",
       "Sports       0\n",
       "Religious    0\n",
       "Nature       0\n",
       "Theatre      0\n",
       "Shopping     0\n",
       "Picnic       0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(249, 7)"
      ]
     },
     "execution_count": 84,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>User Id</th>\n",
       "      <th>Sports</th>\n",
       "      <th>Religious</th>\n",
       "      <th>Nature</th>\n",
       "      <th>Theatre</th>\n",
       "      <th>Shopping</th>\n",
       "      <th>Picnic</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>User 1</td>\n",
       "      <td>2</td>\n",
       "      <td>77</td>\n",
       "      <td>79</td>\n",
       "      <td>69</td>\n",
       "      <td>68</td>\n",
       "      <td>95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>User 2</td>\n",
       "      <td>2</td>\n",
       "      <td>62</td>\n",
       "      <td>76</td>\n",
       "      <td>76</td>\n",
       "      <td>69</td>\n",
       "      <td>68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>User 3</td>\n",
       "      <td>2</td>\n",
       "      <td>50</td>\n",
       "      <td>97</td>\n",
       "      <td>87</td>\n",
       "      <td>50</td>\n",
       "      <td>75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>User 4</td>\n",
       "      <td>2</td>\n",
       "      <td>68</td>\n",
       "      <td>77</td>\n",
       "      <td>95</td>\n",
       "      <td>76</td>\n",
       "      <td>61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>User 5</td>\n",
       "      <td>2</td>\n",
       "      <td>98</td>\n",
       "      <td>54</td>\n",
       "      <td>59</td>\n",
       "      <td>95</td>\n",
       "      <td>86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>User 6</td>\n",
       "      <td>3</td>\n",
       "      <td>52</td>\n",
       "      <td>109</td>\n",
       "      <td>93</td>\n",
       "      <td>52</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>User 7</td>\n",
       "      <td>3</td>\n",
       "      <td>64</td>\n",
       "      <td>85</td>\n",
       "      <td>82</td>\n",
       "      <td>73</td>\n",
       "      <td>69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>User 8</td>\n",
       "      <td>3</td>\n",
       "      <td>54</td>\n",
       "      <td>107</td>\n",
       "      <td>92</td>\n",
       "      <td>54</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>User 9</td>\n",
       "      <td>3</td>\n",
       "      <td>64</td>\n",
       "      <td>108</td>\n",
       "      <td>64</td>\n",
       "      <td>54</td>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>User 10</td>\n",
       "      <td>3</td>\n",
       "      <td>86</td>\n",
       "      <td>76</td>\n",
       "      <td>74</td>\n",
       "      <td>74</td>\n",
       "      <td>103</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>User 11</td>\n",
       "      <td>3</td>\n",
       "      <td>107</td>\n",
       "      <td>54</td>\n",
       "      <td>64</td>\n",
       "      <td>103</td>\n",
       "      <td>94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>User 12</td>\n",
       "      <td>3</td>\n",
       "      <td>103</td>\n",
       "      <td>60</td>\n",
       "      <td>63</td>\n",
       "      <td>102</td>\n",
       "      <td>93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>User 13</td>\n",
       "      <td>3</td>\n",
       "      <td>64</td>\n",
       "      <td>82</td>\n",
       "      <td>82</td>\n",
       "      <td>75</td>\n",
       "      <td>69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>User 14</td>\n",
       "      <td>3</td>\n",
       "      <td>93</td>\n",
       "      <td>54</td>\n",
       "      <td>74</td>\n",
       "      <td>103</td>\n",
       "      <td>69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>User 15</td>\n",
       "      <td>3</td>\n",
       "      <td>63</td>\n",
       "      <td>82</td>\n",
       "      <td>81</td>\n",
       "      <td>78</td>\n",
       "      <td>69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>User 16</td>\n",
       "      <td>3</td>\n",
       "      <td>82</td>\n",
       "      <td>79</td>\n",
       "      <td>75</td>\n",
       "      <td>75</td>\n",
       "      <td>82</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>User 17</td>\n",
       "      <td>5</td>\n",
       "      <td>59</td>\n",
       "      <td>131</td>\n",
       "      <td>103</td>\n",
       "      <td>54</td>\n",
       "      <td>86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>User 18</td>\n",
       "      <td>5</td>\n",
       "      <td>56</td>\n",
       "      <td>124</td>\n",
       "      <td>108</td>\n",
       "      <td>56</td>\n",
       "      <td>85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>User 19</td>\n",
       "      <td>4</td>\n",
       "      <td>85</td>\n",
       "      <td>67</td>\n",
       "      <td>111</td>\n",
       "      <td>65</td>\n",
       "      <td>72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>User 20</td>\n",
       "      <td>5</td>\n",
       "      <td>114</td>\n",
       "      <td>83</td>\n",
       "      <td>65</td>\n",
       "      <td>114</td>\n",
       "      <td>102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>User 21</td>\n",
       "      <td>4</td>\n",
       "      <td>93</td>\n",
       "      <td>82</td>\n",
       "      <td>79</td>\n",
       "      <td>79</td>\n",
       "      <td>90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>User 22</td>\n",
       "      <td>4</td>\n",
       "      <td>105</td>\n",
       "      <td>52</td>\n",
       "      <td>75</td>\n",
       "      <td>113</td>\n",
       "      <td>78</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>User 23</td>\n",
       "      <td>5</td>\n",
       "      <td>69</td>\n",
       "      <td>118</td>\n",
       "      <td>74</td>\n",
       "      <td>66</td>\n",
       "      <td>101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>User 24</td>\n",
       "      <td>4</td>\n",
       "      <td>71</td>\n",
       "      <td>123</td>\n",
       "      <td>64</td>\n",
       "      <td>59</td>\n",
       "      <td>102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>User 25</td>\n",
       "      <td>5</td>\n",
       "      <td>88</td>\n",
       "      <td>94</td>\n",
       "      <td>81</td>\n",
       "      <td>79</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>User 26</td>\n",
       "      <td>5</td>\n",
       "      <td>83</td>\n",
       "      <td>99</td>\n",
       "      <td>89</td>\n",
       "      <td>74</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>User 27</td>\n",
       "      <td>5</td>\n",
       "      <td>69</td>\n",
       "      <td>133</td>\n",
       "      <td>74</td>\n",
       "      <td>54</td>\n",
       "      <td>101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>User 28</td>\n",
       "      <td>5</td>\n",
       "      <td>128</td>\n",
       "      <td>53</td>\n",
       "      <td>74</td>\n",
       "      <td>117</td>\n",
       "      <td>105</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>User 29</td>\n",
       "      <td>5</td>\n",
       "      <td>74</td>\n",
       "      <td>123</td>\n",
       "      <td>69</td>\n",
       "      <td>61</td>\n",
       "      <td>101</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>User 30</td>\n",
       "      <td>5</td>\n",
       "      <td>79</td>\n",
       "      <td>93</td>\n",
       "      <td>118</td>\n",
       "      <td>90</td>\n",
       "      <td>72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>219</th>\n",
       "      <td>User 220</td>\n",
       "      <td>18</td>\n",
       "      <td>114</td>\n",
       "      <td>183</td>\n",
       "      <td>114</td>\n",
       "      <td>109</td>\n",
       "      <td>178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>220</th>\n",
       "      <td>User 221</td>\n",
       "      <td>18</td>\n",
       "      <td>114</td>\n",
       "      <td>173</td>\n",
       "      <td>183</td>\n",
       "      <td>128</td>\n",
       "      <td>124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>221</th>\n",
       "      <td>User 222</td>\n",
       "      <td>18</td>\n",
       "      <td>128</td>\n",
       "      <td>134</td>\n",
       "      <td>188</td>\n",
       "      <td>89</td>\n",
       "      <td>124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>222</th>\n",
       "      <td>User 223</td>\n",
       "      <td>18</td>\n",
       "      <td>143</td>\n",
       "      <td>154</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223</th>\n",
       "      <td>User 224</td>\n",
       "      <td>18</td>\n",
       "      <td>128</td>\n",
       "      <td>163</td>\n",
       "      <td>173</td>\n",
       "      <td>133</td>\n",
       "      <td>130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>224</th>\n",
       "      <td>User 225</td>\n",
       "      <td>18</td>\n",
       "      <td>148</td>\n",
       "      <td>99</td>\n",
       "      <td>139</td>\n",
       "      <td>168</td>\n",
       "      <td>129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>225</th>\n",
       "      <td>User 226</td>\n",
       "      <td>18</td>\n",
       "      <td>83</td>\n",
       "      <td>218</td>\n",
       "      <td>163</td>\n",
       "      <td>74</td>\n",
       "      <td>140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>226</th>\n",
       "      <td>User 227</td>\n",
       "      <td>22</td>\n",
       "      <td>120</td>\n",
       "      <td>168</td>\n",
       "      <td>158</td>\n",
       "      <td>144</td>\n",
       "      <td>133</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>User 228</td>\n",
       "      <td>22</td>\n",
       "      <td>203</td>\n",
       "      <td>99</td>\n",
       "      <td>104</td>\n",
       "      <td>223</td>\n",
       "      <td>173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>User 229</td>\n",
       "      <td>18</td>\n",
       "      <td>143</td>\n",
       "      <td>139</td>\n",
       "      <td>119</td>\n",
       "      <td>139</td>\n",
       "      <td>203</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>User 230</td>\n",
       "      <td>22</td>\n",
       "      <td>153</td>\n",
       "      <td>144</td>\n",
       "      <td>139</td>\n",
       "      <td>144</td>\n",
       "      <td>193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>User 231</td>\n",
       "      <td>18</td>\n",
       "      <td>147</td>\n",
       "      <td>144</td>\n",
       "      <td>129</td>\n",
       "      <td>149</td>\n",
       "      <td>144</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>User 232</td>\n",
       "      <td>18</td>\n",
       "      <td>188</td>\n",
       "      <td>74</td>\n",
       "      <td>109</td>\n",
       "      <td>213</td>\n",
       "      <td>168</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>232</th>\n",
       "      <td>User 233</td>\n",
       "      <td>25</td>\n",
       "      <td>158</td>\n",
       "      <td>154</td>\n",
       "      <td>154</td>\n",
       "      <td>154</td>\n",
       "      <td>153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233</th>\n",
       "      <td>User 234</td>\n",
       "      <td>25</td>\n",
       "      <td>104</td>\n",
       "      <td>208</td>\n",
       "      <td>168</td>\n",
       "      <td>134</td>\n",
       "      <td>144</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>234</th>\n",
       "      <td>User 235</td>\n",
       "      <td>25</td>\n",
       "      <td>139</td>\n",
       "      <td>153</td>\n",
       "      <td>193</td>\n",
       "      <td>158</td>\n",
       "      <td>134</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>235</th>\n",
       "      <td>User 236</td>\n",
       "      <td>25</td>\n",
       "      <td>84</td>\n",
       "      <td>247</td>\n",
       "      <td>168</td>\n",
       "      <td>109</td>\n",
       "      <td>140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>236</th>\n",
       "      <td>User 237</td>\n",
       "      <td>25</td>\n",
       "      <td>173</td>\n",
       "      <td>89</td>\n",
       "      <td>124</td>\n",
       "      <td>233</td>\n",
       "      <td>158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>237</th>\n",
       "      <td>User 238</td>\n",
       "      <td>8</td>\n",
       "      <td>93</td>\n",
       "      <td>119</td>\n",
       "      <td>99</td>\n",
       "      <td>89</td>\n",
       "      <td>138</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>238</th>\n",
       "      <td>User 239</td>\n",
       "      <td>22</td>\n",
       "      <td>124</td>\n",
       "      <td>168</td>\n",
       "      <td>208</td>\n",
       "      <td>148</td>\n",
       "      <td>124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>239</th>\n",
       "      <td>User 240</td>\n",
       "      <td>18</td>\n",
       "      <td>114</td>\n",
       "      <td>158</td>\n",
       "      <td>178</td>\n",
       "      <td>158</td>\n",
       "      <td>124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>240</th>\n",
       "      <td>User 241</td>\n",
       "      <td>20</td>\n",
       "      <td>188</td>\n",
       "      <td>94</td>\n",
       "      <td>94</td>\n",
       "      <td>223</td>\n",
       "      <td>153</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>241</th>\n",
       "      <td>User 242</td>\n",
       "      <td>25</td>\n",
       "      <td>114</td>\n",
       "      <td>238</td>\n",
       "      <td>124</td>\n",
       "      <td>104</td>\n",
       "      <td>178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>242</th>\n",
       "      <td>User 243</td>\n",
       "      <td>18</td>\n",
       "      <td>94</td>\n",
       "      <td>188</td>\n",
       "      <td>148</td>\n",
       "      <td>99</td>\n",
       "      <td>139</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>243</th>\n",
       "      <td>User 244</td>\n",
       "      <td>25</td>\n",
       "      <td>129</td>\n",
       "      <td>318</td>\n",
       "      <td>94</td>\n",
       "      <td>89</td>\n",
       "      <td>188</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>244</th>\n",
       "      <td>User 245</td>\n",
       "      <td>18</td>\n",
       "      <td>139</td>\n",
       "      <td>148</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>168</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>245</th>\n",
       "      <td>User 246</td>\n",
       "      <td>22</td>\n",
       "      <td>114</td>\n",
       "      <td>228</td>\n",
       "      <td>104</td>\n",
       "      <td>84</td>\n",
       "      <td>168</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>246</th>\n",
       "      <td>User 247</td>\n",
       "      <td>20</td>\n",
       "      <td>124</td>\n",
       "      <td>178</td>\n",
       "      <td>104</td>\n",
       "      <td>158</td>\n",
       "      <td>174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>247</th>\n",
       "      <td>User 248</td>\n",
       "      <td>20</td>\n",
       "      <td>133</td>\n",
       "      <td>149</td>\n",
       "      <td>139</td>\n",
       "      <td>144</td>\n",
       "      <td>213</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>248</th>\n",
       "      <td>User 249</td>\n",
       "      <td>20</td>\n",
       "      <td>143</td>\n",
       "      <td>149</td>\n",
       "      <td>139</td>\n",
       "      <td>159</td>\n",
       "      <td>143</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>249 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      User Id  Sports  Religious  Nature  Theatre  Shopping  Picnic\n",
       "0      User 1       2         77      79       69        68      95\n",
       "1      User 2       2         62      76       76        69      68\n",
       "2      User 3       2         50      97       87        50      75\n",
       "3      User 4       2         68      77       95        76      61\n",
       "4      User 5       2         98      54       59        95      86\n",
       "5      User 6       3         52     109       93        52      76\n",
       "6      User 7       3         64      85       82        73      69\n",
       "7      User 8       3         54     107       92        54      76\n",
       "8      User 9       3         64     108       64        54      93\n",
       "9     User 10       3         86      76       74        74     103\n",
       "10    User 11       3        107      54       64       103      94\n",
       "11    User 12       3        103      60       63       102      93\n",
       "12    User 13       3         64      82       82        75      69\n",
       "13    User 14       3         93      54       74       103      69\n",
       "14    User 15       3         63      82       81        78      69\n",
       "15    User 16       3         82      79       75        75      82\n",
       "16    User 17       5         59     131      103        54      86\n",
       "17    User 18       5         56     124      108        56      85\n",
       "18    User 19       4         85      67      111        65      72\n",
       "19    User 20       5        114      83       65       114     102\n",
       "20    User 21       4         93      82       79        79      90\n",
       "21    User 22       4        105      52       75       113      78\n",
       "22    User 23       5         69     118       74        66     101\n",
       "23    User 24       4         71     123       64        59     102\n",
       "24    User 25       5         88      94       81        79      91\n",
       "25    User 26       5         83      99       89        74      91\n",
       "26    User 27       5         69     133       74        54     101\n",
       "27    User 28       5        128      53       74       117     105\n",
       "28    User 29       5         74     123       69        61     101\n",
       "29    User 30       5         79      93      118        90      72\n",
       "..        ...     ...        ...     ...      ...       ...     ...\n",
       "219  User 220      18        114     183      114       109     178\n",
       "220  User 221      18        114     173      183       128     124\n",
       "221  User 222      18        128     134      188        89     124\n",
       "222  User 223      18        143     154      129       129     178\n",
       "223  User 224      18        128     163      173       133     130\n",
       "224  User 225      18        148      99      139       168     129\n",
       "225  User 226      18         83     218      163        74     140\n",
       "226  User 227      22        120     168      158       144     133\n",
       "227  User 228      22        203      99      104       223     173\n",
       "228  User 229      18        143     139      119       139     203\n",
       "229  User 230      22        153     144      139       144     193\n",
       "230  User 231      18        147     144      129       149     144\n",
       "231  User 232      18        188      74      109       213     168\n",
       "232  User 233      25        158     154      154       154     153\n",
       "233  User 234      25        104     208      168       134     144\n",
       "234  User 235      25        139     153      193       158     134\n",
       "235  User 236      25         84     247      168       109     140\n",
       "236  User 237      25        173      89      124       233     158\n",
       "237  User 238       8         93     119       99        89     138\n",
       "238  User 239      22        124     168      208       148     124\n",
       "239  User 240      18        114     158      178       158     124\n",
       "240  User 241      20        188      94       94       223     153\n",
       "241  User 242      25        114     238      124       104     178\n",
       "242  User 243      18         94     188      148        99     139\n",
       "243  User 244      25        129     318       94        89     188\n",
       "244  User 245      18        139     148      129       129     168\n",
       "245  User 246      22        114     228      104        84     168\n",
       "246  User 247      20        124     178      104       158     174\n",
       "247  User 248      20        133     149      139       144     213\n",
       "248  User 249      20        143     149      139       159     143\n",
       "\n",
       "[249 rows x 7 columns]"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [],
   "source": [
    "conn = sqlite3.connect('buddymove_holidayiq.sqlite3')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/ok/anaconda3/lib/python3.7/site-packages/pandas/core/generic.py:2531: UserWarning: The spaces in these column names will not be changed. In pandas versions < 0.14, spaces were converted to underscores.\n",
      "  dtype=dtype, method=method)\n"
     ]
    }
   ],
   "source": [
    "df.to_sql('review', conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Opened as needed\n"
     ]
    }
   ],
   "source": [
    "cursor = conn.cursor()\n",
    "print(\"Opened as needed\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(0, 'User 1', 2, 77, 79, 69, 68, 95),\n",
       " (1, 'User 2', 2, 62, 76, 76, 69, 68),\n",
       " (2, 'User 3', 2, 50, 97, 87, 50, 75),\n",
       " (3, 'User 4', 2, 68, 77, 95, 76, 61),\n",
       " (4, 'User 5', 2, 98, 54, 59, 95, 86),\n",
       " (5, 'User 6', 3, 52, 109, 93, 52, 76),\n",
       " (6, 'User 7', 3, 64, 85, 82, 73, 69),\n",
       " (7, 'User 8', 3, 54, 107, 92, 54, 76),\n",
       " (8, 'User 9', 3, 64, 108, 64, 54, 93),\n",
       " (9, 'User 10', 3, 86, 76, 74, 74, 103),\n",
       " (10, 'User 11', 3, 107, 54, 64, 103, 94),\n",
       " (11, 'User 12', 3, 103, 60, 63, 102, 93),\n",
       " (12, 'User 13', 3, 64, 82, 82, 75, 69),\n",
       " (13, 'User 14', 3, 93, 54, 74, 103, 69),\n",
       " (14, 'User 15', 3, 63, 82, 81, 78, 69),\n",
       " (15, 'User 16', 3, 82, 79, 75, 75, 82),\n",
       " (16, 'User 17', 5, 59, 131, 103, 54, 86),\n",
       " (17, 'User 18', 5, 56, 124, 108, 56, 85),\n",
       " (18, 'User 19', 4, 85, 67, 111, 65, 72),\n",
       " (19, 'User 20', 5, 114, 83, 65, 114, 102),\n",
       " (20, 'User 21', 4, 93, 82, 79, 79, 90),\n",
       " (21, 'User 22', 4, 105, 52, 75, 113, 78),\n",
       " (22, 'User 23', 5, 69, 118, 74, 66, 101),\n",
       " (23, 'User 24', 4, 71, 123, 64, 59, 102),\n",
       " (24, 'User 25', 5, 88, 94, 81, 79, 91),\n",
       " (25, 'User 26', 5, 83, 99, 89, 74, 91),\n",
       " (26, 'User 27', 5, 69, 133, 74, 54, 101),\n",
       " (27, 'User 28', 5, 128, 53, 74, 117, 105),\n",
       " (28, 'User 29', 5, 74, 123, 69, 61, 101),\n",
       " (29, 'User 30', 5, 79, 93, 118, 90, 72),\n",
       " (30, 'User 31', 4, 51, 115, 110, 51, 84),\n",
       " (31, 'User 32', 5, 69, 93, 93, 81, 79),\n",
       " (32, 'User 33', 4, 100, 53, 86, 112, 78),\n",
       " (33, 'User 34', 4, 88, 69, 108, 71, 77),\n",
       " (34, 'User 35', 4, 93, 84, 75, 84, 112),\n",
       " (35, 'User 36', 4, 79, 86, 110, 93, 73),\n",
       " (36, 'User 37', 4, 87, 72, 112, 63, 71),\n",
       " (37, 'User 38', 5, 65, 128, 79, 56, 101),\n",
       " (38, 'User 39', 4, 91, 66, 110, 69, 71),\n",
       " (39, 'User 40', 4, 93, 79, 74, 92, 90),\n",
       " (40, 'User 41', 5, 59, 118, 108, 63, 85),\n",
       " (41, 'User 42', 5, 65, 103, 90, 80, 79),\n",
       " (42, 'User 43', 4, 87, 89, 76, 89, 111),\n",
       " (43, 'User 44', 4, 93, 85, 79, 85, 91),\n",
       " (44, 'User 45', 5, 93, 94, 79, 79, 113),\n",
       " (45, 'User 46', 5, 74, 130, 74, 53, 101),\n",
       " (46, 'User 47', 4, 118, 59, 69, 119, 97),\n",
       " (47, 'User 48', 4, 101, 61, 76, 113, 78),\n",
       " (48, 'User 49', 5, 88, 99, 79, 83, 114),\n",
       " (49, 'User 50', 4, 74, 87, 87, 79, 79),\n",
       " (50, 'User 51', 14, 148, 59, 104, 208, 119),\n",
       " (51, 'User 52', 5, 93, 89, 74, 89, 93),\n",
       " (52, 'User 53', 4, 79, 103, 68, 103, 85),\n",
       " (53, 'User 54', 4, 76, 92, 111, 90, 71),\n",
       " (54, 'User 55', 8, 94, 140, 89, 118, 92),\n",
       " (55, 'User 56', 8, 108, 109, 89, 89, 143),\n",
       " (56, 'User 57', 6, 98, 89, 133, 79, 79),\n",
       " (57, 'User 58', 8, 84, 118, 102, 94, 90),\n",
       " (58, 'User 59', 8, 138, 74, 79, 143, 118),\n",
       " (59, 'User 60', 6, 74, 109, 103, 89, 88),\n",
       " (60, 'User 61', 8, 118, 104, 94, 94, 118),\n",
       " (61, 'User 62', 8, 94, 128, 89, 128, 99),\n",
       " (62, 'User 63', 8, 64, 155, 118, 64, 97),\n",
       " (63, 'User 64', 6, 84, 108, 138, 103, 79),\n",
       " (64, 'User 65', 8, 108, 109, 94, 99, 138),\n",
       " (65, 'User 66', 6, 89, 108, 128, 116, 81),\n",
       " (66, 'User 67', 6, 103, 79, 148, 74, 79),\n",
       " (67, 'User 68', 6, 103, 109, 99, 89, 108),\n",
       " (68, 'User 69', 8, 108, 99, 94, 94, 138),\n",
       " (69, 'User 70', 8, 108, 109, 104, 79, 133),\n",
       " (70, 'User 71', 8, 138, 59, 84, 138, 128),\n",
       " (71, 'User 72', 8, 79, 143, 113, 69, 109),\n",
       " (72, 'User 73', 8, 84, 153, 79, 64, 113),\n",
       " (73, 'User 74', 8, 74, 148, 118, 64, 104),\n",
       " (74, 'User 75', 8, 74, 153, 118, 59, 99),\n",
       " (75, 'User 76', 6, 118, 64, 101, 133, 92),\n",
       " (76, 'User 77', 6, 69, 153, 113, 59, 99),\n",
       " (77, 'User 78', 6, 123, 68, 89, 128, 90),\n",
       " (78, 'User 79', 6, 99, 104, 128, 64, 78),\n",
       " (79, 'User 80', 6, 124, 59, 84, 143, 88),\n",
       " (80, 'User 81', 6, 84, 131, 128, 93, 81),\n",
       " (81, 'User 82', 6, 113, 64, 89, 141, 86),\n",
       " (82, 'User 83', 6, 118, 64, 99, 134, 88),\n",
       " (83, 'User 84', 8, 89, 143, 84, 64, 118),\n",
       " (84, 'User 85', 6, 98, 89, 133, 69, 79),\n",
       " (85, 'User 86', 6, 98, 104, 109, 91, 101),\n",
       " (86, 'User 87', 8, 84, 143, 74, 74, 133),\n",
       " (87, 'User 88', 8, 123, 64, 93, 148, 90),\n",
       " (88, 'User 89', 6, 84, 113, 141, 98, 81),\n",
       " (89, 'User 90', 6, 59, 148, 125, 59, 97),\n",
       " (90, 'User 91', 8, 143, 69, 79, 143, 123),\n",
       " (91, 'User 92', 8, 94, 133, 84, 125, 97),\n",
       " (92, 'User 93', 8, 84, 108, 113, 93, 90),\n",
       " (93, 'User 94', 8, 84, 138, 89, 69, 123),\n",
       " (94, 'User 95', 6, 84, 108, 133, 98, 81),\n",
       " (95, 'User 96', 6, 99, 84, 138, 69, 83),\n",
       " (96, 'User 97', 8, 113, 94, 84, 109, 128),\n",
       " (97, 'User 98', 6, 148, 64, 74, 138, 128),\n",
       " (98, 'User 99', 8, 84, 138, 113, 64, 114),\n",
       " (99, 'User 100', 6, 98, 79, 138, 79, 79),\n",
       " (100, 'User 101', 8, 133, 84, 84, 133, 118),\n",
       " (101, 'User 102', 6, 79, 113, 106, 87, 88),\n",
       " (102, 'User 103', 8, 113, 104, 84, 94, 148),\n",
       " (103, 'User 104', 6, 69, 138, 113, 79, 99),\n",
       " (104, 'User 105', 6, 83, 103, 98, 99, 90),\n",
       " (105, 'User 106', 8, 69, 143, 123, 71, 97),\n",
       " (106, 'User 107', 8, 118, 94, 99, 99, 143),\n",
       " (107, 'User 108', 6, 74, 133, 99, 74, 113),\n",
       " (108, 'User 109', 12, 115, 94, 163, 109, 92),\n",
       " (109, 'User 110', 12, 123, 124, 109, 114, 168),\n",
       " (110, 'User 111', 12, 94, 133, 157, 133, 95),\n",
       " (111, 'User 112', 12, 104, 123, 163, 128, 89),\n",
       " (112, 'User 113', 14, 99, 198, 89, 74, 153),\n",
       " (113, 'User 114', 14, 113, 148, 99, 148, 110),\n",
       " (114, 'User 115', 14, 94, 163, 99, 94, 153),\n",
       " (115, 'User 116', 12, 133, 104, 119, 129, 133),\n",
       " (116, 'User 117', 14, 163, 69, 94, 188, 143),\n",
       " (117, 'User 118', 12, 74, 158, 158, 74, 119),\n",
       " (118, 'User 119', 12, 123, 124, 109, 129, 143),\n",
       " (119, 'User 120', 12, 94, 137, 148, 113, 100),\n",
       " (120, 'User 121', 12, 123, 129, 139, 99, 143),\n",
       " (121, 'User 122', 12, 89, 163, 99, 79, 143),\n",
       " (122, 'User 123', 14, 81, 173, 143, 79, 122),\n",
       " (123, 'User 124', 14, 135, 84, 158, 139, 92),\n",
       " (124, 'User 125', 12, 108, 113, 133, 114, 100),\n",
       " (125, 'User 126', 14, 138, 119, 119, 124, 158),\n",
       " (126, 'User 127', 12, 128, 122, 134, 109, 120),\n",
       " (127, 'User 128', 14, 79, 203, 153, 69, 119),\n",
       " (128, 'User 129', 12, 84, 150, 128, 104, 102),\n",
       " (129, 'User 130', 12, 148, 69, 104, 173, 138),\n",
       " (130, 'User 131', 14, 133, 124, 119, 124, 168),\n",
       " (131, 'User 132', 12, 89, 128, 148, 111, 102),\n",
       " (132, 'User 133', 12, 79, 183, 133, 70, 113),\n",
       " (133, 'User 134', 12, 96, 113, 113, 99, 97),\n",
       " (134, 'User 135', 14, 84, 161, 153, 84, 116),\n",
       " (135, 'User 136', 12, 109, 135, 158, 123, 92),\n",
       " (136, 'User 137', 12, 133, 74, 114, 175, 102),\n",
       " (137, 'User 138', 14, 133, 139, 124, 109, 128),\n",
       " (138, 'User 139', 12, 128, 124, 114, 111, 126),\n",
       " (139, 'User 140', 10, 97, 123, 108, 119, 111),\n",
       " (140, 'User 141', 12, 123, 104, 104, 134, 153),\n",
       " (141, 'User 142', 10, 113, 89, 168, 89, 89),\n",
       " (142, 'User 143', 12, 109, 148, 94, 133, 119),\n",
       " (143, 'User 144', 10, 165, 64, 94, 173, 97),\n",
       " (144, 'User 145', 12, 93, 123, 123, 124, 100),\n",
       " (145, 'User 146', 14, 143, 98, 119, 163, 105),\n",
       " (146, 'User 147', 12, 89, 158, 89, 89, 158),\n",
       " (147, 'User 148', 10, 113, 111, 153, 84, 97),\n",
       " (148, 'User 149', 12, 138, 86, 114, 158, 102),\n",
       " (149, 'User 150', 12, 79, 158, 148, 69, 119),\n",
       " (150, 'User 151', 14, 84, 178, 138, 87, 116),\n",
       " (151, 'User 152', 14, 84, 168, 148, 80, 113),\n",
       " (152, 'User 153', 14, 84, 173, 143, 69, 110),\n",
       " (153, 'User 154', 12, 104, 130, 178, 118, 92),\n",
       " (154, 'User 155', 10, 99, 123, 153, 128, 103),\n",
       " (155, 'User 156', 12, 93, 128, 118, 119, 100),\n",
       " (156, 'User 157', 12, 128, 119, 104, 119, 173),\n",
       " (157, 'User 158', 14, 94, 178, 109, 69, 143),\n",
       " (158, 'User 159', 12, 148, 69, 104, 168, 114),\n",
       " (159, 'User 160', 12, 113, 114, 109, 119, 143),\n",
       " (160, 'User 161', 12, 153, 74, 94, 163, 158),\n",
       " (161, 'User 162', 22, 139, 163, 114, 203, 139),\n",
       " (162, 'User 163', 14, 163, 99, 94, 158, 143),\n",
       " (163, 'User 164', 12, 89, 178, 89, 79, 153),\n",
       " (164, 'User 165', 12, 79, 183, 104, 69, 148),\n",
       " (165, 'User 166', 12, 168, 69, 84, 198, 133),\n",
       " (166, 'User 167', 22, 128, 158, 183, 158, 130),\n",
       " (167, 'User 168', 22, 129, 188, 109, 104, 198),\n",
       " (168, 'User 169', 16, 178, 74, 114, 198, 129),\n",
       " (169, 'User 170', 20, 143, 139, 139, 139, 148),\n",
       " (170, 'User 171', 20, 114, 198, 124, 114, 153),\n",
       " (171, 'User 172', 18, 105, 158, 143, 129, 133),\n",
       " (172, 'User 173', 20, 120, 193, 104, 148, 138),\n",
       " (173, 'User 174', 20, 98, 193, 163, 99, 140),\n",
       " (174, 'User 175', 22, 148, 174, 129, 129, 153),\n",
       " (175, 'User 176', 20, 183, 104, 164, 193, 153),\n",
       " (176, 'User 177', 18, 99, 203, 129, 94, 158),\n",
       " (177, 'User 178', 22, 139, 178, 139, 163, 144),\n",
       " (178, 'User 179', 22, 90, 188, 163, 109, 138),\n",
       " (179, 'User 180', 18, 163, 84, 129, 193, 139),\n",
       " (180, 'User 181', 18, 88, 178, 178, 89, 140),\n",
       " (181, 'User 182', 18, 114, 144, 213, 133, 128),\n",
       " (182, 'User 183', 22, 143, 124, 208, 134, 124),\n",
       " (183, 'User 184', 20, 188, 94, 104, 208, 158),\n",
       " (184, 'User 185', 18, 99, 228, 104, 84, 163),\n",
       " (185, 'User 186', 18, 178, 94, 114, 188, 173),\n",
       " (186, 'User 187', 22, 119, 198, 149, 114, 168),\n",
       " (187, 'User 188', 20, 114, 203, 109, 84, 158),\n",
       " (188, 'User 189', 18, 99, 193, 158, 99, 144),\n",
       " (189, 'User 190', 22, 153, 139, 154, 154, 183),\n",
       " (190, 'User 191', 20, 162, 94, 144, 198, 135),\n",
       " (191, 'User 192', 18, 132, 149, 139, 119, 144),\n",
       " (192, 'User 193', 18, 104, 193, 114, 99, 173),\n",
       " (193, 'User 194', 18, 99, 183, 128, 114, 129),\n",
       " (194, 'User 195', 20, 178, 89, 154, 198, 183),\n",
       " (195, 'User 196', 20, 114, 243, 104, 79, 173),\n",
       " (196, 'User 197', 22, 133, 183, 114, 183, 140),\n",
       " (197, 'User 198', 22, 148, 149, 154, 149, 148),\n",
       " (198, 'User 199', 22, 114, 213, 129, 94, 178),\n",
       " (199, 'User 200', 22, 188, 124, 114, 183, 188),\n",
       " (200, 'User 201', 25, 153, 159, 129, 139, 218),\n",
       " (201, 'User 202', 18, 114, 153, 178, 138, 124),\n",
       " (202, 'User 203', 22, 184, 84, 129, 233, 133),\n",
       " (203, 'User 204', 18, 84, 193, 188, 80, 138),\n",
       " (204, 'User 205', 18, 178, 129, 104, 183, 163),\n",
       " (205, 'User 206', 18, 114, 163, 163, 148, 124),\n",
       " (206, 'User 207', 16, 132, 94, 178, 109, 120),\n",
       " (207, 'User 208', 20, 93, 183, 178, 89, 140),\n",
       " (208, 'User 209', 16, 137, 104, 173, 109, 130),\n",
       " (209, 'User 210', 18, 153, 74, 114, 188, 129),\n",
       " (210, 'User 211', 18, 128, 114, 168, 124, 124),\n",
       " (211, 'User 212', 22, 114, 228, 119, 99, 168),\n",
       " (212, 'User 213', 22, 178, 89, 114, 203, 139),\n",
       " (213, 'User 214', 18, 173, 84, 99, 193, 158),\n",
       " (214, 'User 215', 20, 168, 89, 124, 183, 129),\n",
       " (215, 'User 216', 18, 83, 198, 163, 84, 140),\n",
       " (216, 'User 217', 22, 144, 173, 134, 173, 149),\n",
       " (217, 'User 218', 18, 198, 64, 89, 203, 153),\n",
       " (218, 'User 219', 20, 114, 208, 114, 119, 168),\n",
       " (219, 'User 220', 18, 114, 183, 114, 109, 178),\n",
       " (220, 'User 221', 18, 114, 173, 183, 128, 124),\n",
       " (221, 'User 222', 18, 128, 134, 188, 89, 124),\n",
       " (222, 'User 223', 18, 143, 154, 129, 129, 178),\n",
       " (223, 'User 224', 18, 128, 163, 173, 133, 130),\n",
       " (224, 'User 225', 18, 148, 99, 139, 168, 129),\n",
       " (225, 'User 226', 18, 83, 218, 163, 74, 140),\n",
       " (226, 'User 227', 22, 120, 168, 158, 144, 133),\n",
       " (227, 'User 228', 22, 203, 99, 104, 223, 173),\n",
       " (228, 'User 229', 18, 143, 139, 119, 139, 203),\n",
       " (229, 'User 230', 22, 153, 144, 139, 144, 193),\n",
       " (230, 'User 231', 18, 147, 144, 129, 149, 144),\n",
       " (231, 'User 232', 18, 188, 74, 109, 213, 168),\n",
       " (232, 'User 233', 25, 158, 154, 154, 154, 153),\n",
       " (233, 'User 234', 25, 104, 208, 168, 134, 144),\n",
       " (234, 'User 235', 25, 139, 153, 193, 158, 134),\n",
       " (235, 'User 236', 25, 84, 247, 168, 109, 140),\n",
       " (236, 'User 237', 25, 173, 89, 124, 233, 158),\n",
       " (237, 'User 238', 8, 93, 119, 99, 89, 138),\n",
       " (238, 'User 239', 22, 124, 168, 208, 148, 124),\n",
       " (239, 'User 240', 18, 114, 158, 178, 158, 124),\n",
       " (240, 'User 241', 20, 188, 94, 94, 223, 153),\n",
       " (241, 'User 242', 25, 114, 238, 124, 104, 178),\n",
       " (242, 'User 243', 18, 94, 188, 148, 99, 139),\n",
       " (243, 'User 244', 25, 129, 318, 94, 89, 188),\n",
       " (244, 'User 245', 18, 139, 148, 129, 129, 168),\n",
       " (245, 'User 246', 22, 114, 228, 104, 84, 168),\n",
       " (246, 'User 247', 20, 124, 178, 104, 158, 174),\n",
       " (247, 'User 248', 20, 133, 149, 139, 144, 213),\n",
       " (248, 'User 249', 20, 143, 149, 139, 159, 143)]"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cursor.execute(\"SELECT * FROM review\").fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(78,)]"
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cursor.execute('''SELECT COUNT(*) FROM review\n",
    "                WHERE (Nature > 100) AND (Shopping > 100)\n",
    "               ''').fetchall()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<function Connection.close>"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "conn.commit\n",
    "conn.close"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
